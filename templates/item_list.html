{% extends 'base.html' %}

{% block title %}{{ user }}'s items{% endblock title %}

<div class="container">
{% block search_result %}
{% endblock search_result %}
</div>

{% block content %}
    <h2>Available Items</h2>
    {% for item in items_list %}
    <div class="card">
        <div class="card-body d-flex flex-row">
            <div class="d-flex flex-column">
                <a href="{% url 'item_detail' item.pk %}"><h4>{{ item.name }}</h4></a>
                <p class="text-success">Status: Available</p>
                <p>{{ item.desc }}</p>
            </div>
            {% if item.borrower %}
            <div class="d-flex ml-auto flex-column">
                <a class="btn btn-danger" role="button" href="{% url 'item_return' item.pk %}">Mark as Returned</a>
            </div>
            {% endif %}
        </div>
        <div class="card-footer">
            <a href="{% url 'item_update' item.pk %}" class="btn" role="button">Edit</a>
            <a href="{% url 'item_delete' item.pk %}" class="btn" role="button">Delete</a>
        </div>
    </div>
    </br>
    {% empty %}
    <p>You don't have any available item. <a href="{% url 'item_new' %}">Add an item</a> to lend your unused items!</p>
    {% endfor %}
    
    <h2>Lent Item</h2>
    {% for borrowed_item_record in borrowed_item_records %}
    <div class="card">
        <div class="card-body d-flex flex-row">
            <div class="d-flex flex-column">
                <a href="{% url 'item_detail' borrowed_item_record.item_borrowed.pk %}"><h4>{{ borrowed_item_record.item_borrowed.name }}</h4></a>
                <p class="text-muted">Status: Borrowed by {{ borrowed_item_record.borrower }} on {{ borrowed_item_record.borrow_date }}</p>
                <p class="text-danger">Return Date: {{ borrowed_item_record.return_date }}</p>
                <p>{{ borrowed_item_record.item_borrowed.desc }}</p>
            </div>
            <div class="d-flex ml-auto flex-column">
                <a class="btn btn-danger" role="button" href="{% url 'item_return' borrowed_item_record.pk %}">Mark as Returned</a>
            </div>
        </div>
        <div class="card-footer">
            <a href="{% url 'item_delete' borrowed_item_record.item_borrowed.pk %}" class="btn" role="button">Delete</a>
        </div>
    </div>
    </br>
    {% empty %}
    <p>None is currently borrowing your item</p>
    {% endfor %}
{% endblock content %}
